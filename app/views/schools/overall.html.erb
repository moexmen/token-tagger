<script>
  function goToDate(e) {
    const date = e.target.value;
    console.log(e, e.target.value)
    if (date != null) {
      window.location.href = `<%= url_for controller: 'schools', action: 'overall'%>/?date=${date}`;
    }
  }
</script>

<h2>Summary for <input type="date" onchange="goToDate(event)" value=<%= @date %>></h2>

<% if @schools.empty? %>
  <h2>No schools tagged on <%= @date.strftime('%b %d (%a)') %></h2>
<% end %>

<% if !@schools.empty? %>
  <table>
    <tr>
      <th>School</th>
      <th>Tagged on <%= @date.strftime('%m/%d') %></th>
      <th>Total Tagged</th>
      <th>Pending</th>
      <th>Already collected</th>
      <th>Total</th>
    </tr>

    <% @schools.each do |school| %>
      <tr>
        <td><%= school.name %></td>
        <td><%= @date_counts[school.code] %></td>
        <td><%= @counts_by_school[school.code]['assigned'] || 0 %></td>
        <td><%= @counts_by_school[school.code]['pending'] || 0 %></td>
        <td><%= @counts_by_school[school.code]['error_quota'] || 0 %></td>
        <td><%= @counts_by_school[school.code].values.reduce(0, :+) %></td>
      </tr>
    <% end %>
    <tr>
      <th>Total</th><td><%= @date_counts.values.reduce(0, :+) %></td>
    </tr>
  </table>
<% end %>
